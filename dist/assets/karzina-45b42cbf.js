import{u as L}from"./HTTP.request-89c4859f.js";import{h as H,r as _,f as T,b as x}from"./ui-960fc6a0.js";H();let d=document.querySelector(".void-karzina"),p=document.querySelector(".visidel"),{request:z}=L(),s=JSON.parse(localStorage.getItem("korzina_data"))||[],$=JSON.parse(localStorage.getItem("like_data"))||[],r={};_($,".saveds__count");_(s,".shop__counter");d!==null&&(!s.length>0?(p.style.display="none",d.style.display="flex"):(p.style.display="flex",d.style.display="none"));z("/goods","get").then(o=>b(s,o));function b(o,c){let n=document.querySelector(".like_data-karzina-wrapper");n.innerHTML="";for(let e of c)for(let t of o)if(e.id===+t){let l=0;e.salePercentage>0?l=e.price-Math.floor(e.price/100*e.salePercentage):l=e.price,n.innerHTML+=`<div class="product-item item" id="${e.id}">
            <img src="${e.media[0]}" alt="${e.type}" width="143px " height="187px" class="img">
      <div class="item-info info">
         <h3>${e.title}</h3>
         <span class="sale-price text" data-price=${e.price}>${l+" сум"}</span>
         <div class="karzina-counter">
            <button class="minus">-</button>
            <span class="span">1</span>
            <button class="plus">+</button>
         </div>
         <button class="item-del">
            Удалить
         </button>
      </div>
   </div>`}let y=document.querySelectorAll(".product-item");!s.length>0?(n.style.display="none",p.style.display="none",d.style.display="flex"):(n.style.display="flex",p.style.display="flex",d.style.display="none"),y.forEach(e=>{let t=1;r[e.id]=t,g(r);let l=document.querySelector(".like_data-karzina-wrapper"),i=e.querySelector(".info"),u=i.querySelector("h3"),M=i.querySelector(".karzina-counter"),h=i.querySelector(".item-del"),f=i.querySelector(".text"),q=e.querySelector(".minus"),k=e.querySelector(".plus"),S=e.querySelector(".span");!s.length>0?l.style.display="none":l.style.display="flex";let m=f.innerHTML.split(" ").at(0);m=+m,e.addEventListener("click",function(a){if(a.target!==i&&a.target!==u&&a.target!==M&&a.target!==h&&a.target!==f&&a.target!==q&&a.target!==k&&a.target!==S){let v=[];v.push(e.id),localStorage.setItem("open_el",JSON.stringify(v)),location.assign("/pages/product/")}}),q.onclick=()=>{t>1&&(t--,r[e.id]=t,S.innerHTML=t,f.innerHTML=m*t+" сум",g(r))},k.onclick=()=>{t++,r[e.id]=t,S.innerHTML=t,f.innerHTML=m*t+" сум",g(r)},h.onclick=()=>{s=s.filter(a=>a!==e.id),localStorage.setItem("korzina_data",JSON.stringify(s)),e.remove(),!s.length>0?(l.style.display="none",p.style.display="none",d.style.display="flex"):(l.style.display="flex",p.style.display="flex",d.style.display="none"),_(s,".shop__counter"),delete r[e.id],g(r)}})}function N(o,c){let n=document.querySelector(".visidel"),y=n.querySelectorAll(".visidel__text"),e=n.querySelector(".visidel__price"),t=0;for(let l in r){let i=r[l];t+=i}y.forEach(l=>{+l.dataset.index==1?l.innerHTML=`Итого товаров: ${t} шт.`:l.innerHTML=`Итого скидки: ${x(o)} сум`}),e.innerHTML=`${x(c)} сум`,t=0}function g(o){let c=0,n=0;document.querySelectorAll(".product-item").forEach(e=>{let l=e.querySelector(".info").querySelector(".text"),i=l.innerHTML.split(" ").at(0),u=l.dataset.price;u=+u,i=+i,n+=u*o[e.id]-i,c+=i}),N(n,c),n=0,c=0}T();
